<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS-Feed Anzeige</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; padding: 20px; }
        #rss-feed-container { width: 100%; max-width: 800px; }
        .rss-entry { border: 1px solid #ccc; border-radius: 8px; padding: 10px; margin-bottom: 10px; display: flex; align-items: center; }
        .rss-entry img { width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 10px; }
        .rss-entry h3 { margin: 0; font-size: 1.2em; }
        .rss-entry a { display: block; margin-top: 5px; color: #007bff; text-decoration: none; }
    </style>
</head>
<body>
    <div id="rss-feed-container"></div>

    <script>
        // Definiere die Variablen direkt im JavaScript
        const RSS_BASE_URL = 'http://openmanniland.de';
        const RSS_MAIN_FOLDER = '/webinterface';
        const RSS_FEED_FOLDER = '/include';
        const RSS_IMAGE_FOLDER = '/calendar';
        
        const feedUrl = `${RSS_BASE_URL}${RSS_MAIN_FOLDER}${RSS_FEED_FOLDER}/rss-feed.php`;

        async function fetchRSSFeed(url) {
            const response = await fetch(url);
            const text = await response.text();
            const parser = new DOMParser();
            const xml = parser.parseFromString(text, 'application/xml');
            return xml;
        }

        function renderRSSFeed(xml) {
            const items = xml.querySelectorAll('item');
            const container = document.getElementById('rss-feed-container');

            items.forEach(item => {
                const title = item.querySelector('title').textContent;
                const link = item.querySelector('link').textContent;
                const description = item.querySelector('description').textContent;
                const imageUrl = item.querySelector('image') ? item.querySelector('image').textContent : '';

                console.log(`Image URL: ${imageUrl}`);

                const entry = document.createElement('div');
                entry.classList.add('rss-entry');

                if (imageUrl) {
                    const img = document.createElement('img');
                    img.src = imageUrl;
                    img.onload = () => console.log(`Image loaded: ${img.src}`);
                    img.onerror = () => console.error(`Failed to load image: ${img.src}`);
                    entry.appendChild(img);
                }

                const entryContent = document.createElement('div');
                entryContent.classList.add('entry-content');

                const entryTitle = document.createElement('h3');
                entryTitle.textContent = title;

                const entryLink = document.createElement('a');
                entryLink.href = link;
                entryLink.textContent = 'Read more';

                const entryDescription = document.createElement('p');
                entryDescription.innerHTML = description;

                entryContent.appendChild(entryTitle);
                entryContent.appendChild(entryDescription);
                entryContent.appendChild(entryLink);

                entry.appendChild(entryContent);
                container.appendChild(entry);
            });
        }

        async function loadRSSFeed() {
            const xml = await fetchRSSFeed(feedUrl);
            renderRSSFeed(xml);
        }

        loadRSSFeed();
    </script>
</body>
</html>
